### LU分解
$$
A = LU \Rightarrow A^{-1} = U^{-1}L^{-1}
$$
**step1:将 A (m*m)矩阵分解为 L 下三角矩阵和 U 上三角矩阵**
1. L的对角线填充为1
2. $U_{0,j}=A_{0,j}$
3. $L_{i,0} =  \frac{A_{i,0}}{U_{0,0}}$
4. $$
  for \quad k = 1:m-1: \\
  \quad U_{k,j} = A_{k,j}-\sum^{k-1}_{t=0}L_{k,t}U_{t,j}(j=k,k+1,k+2\dots m-1)\\
  L_{i,k} = \frac{A_{i,k}-\sum^{k-1}_{t=0}L_{i,t}U_{t,k}}{U_{k,k}}(i = k+1,k+2\dots m-1)
  $$

5. 

**step2:将L，U分别求逆**

$L^{-1}$的计算顺序是列顺序，行顺序
$$
L_{inv}(i,j) = \left\{
\begin{matrix}
1\quad i=j\\
0 \quad i<j\\
-\sum^{i-1}_{t=j}L(i,t)L_{inv}(t,j) \quad i>j
\end{matrix}
\right.
$$
$U^{-1}$的计算顺序是列顺序，行倒序
$$
U_{inv}(i,j) = \left\{
\begin{matrix}
\frac{1}{U_{inv}(i,j)}\quad i=j\\
0 \quad i>j\\
-\sum^{j}_{t=i+1}U(i,t)U_{inv}(t,j)/U(j,j) \quad i<j
\end{matrix}
\right.
$$


```python
def LU(A):
    """
    对A进行LU分解，并求A的逆矩阵
    """
    m = A.shape[0]
    L = np.zeros((m, m))
    U = np.zeros((m, m))
    for i in range(m):
        L[i, i] = 1  # Set diagonal of L to 1
    for j in range(m):
        U[0, j] = A[0, j]
    for i in range(m):
        L[i, 0] = A[i, 0] / U[0, 0] 
    for k in range(1,m):
        for j in range(k, m):
            U[k, j] = A[k, j]  # Initialize U[k, j] directly
            for t in range(k):
                U[k, j] -= L[k, t] * U[t, j]
            
        for i in range(k+1, m):
            L[i, k] = A[i, k]
            for t in range(k):
                L[i, k] -= L[i, t] * U[t, k]
            L[i,k] /= U[k, k]
    U_inv = np.zeros((m, m))
    L_inv = np.zeros((m, m))
    for i in range(m):
        L_inv[i, i] = 1
        U_inv[i, i] = 1 / U[i, i]
    # 计算L的逆矩阵
    for j in range(m):
        for i in range(j+1, m):
            for t in range(j+1):
                L_inv[i, j] -= L[i, t] * L_inv[t, j]
    # 计算U的逆矩阵
    for j in range(m):
        for i in range(j-1, -1, -1):
            for t in range(i+1, m):
                U_inv[i, j] -= U[i, t] * U_inv[t, j]
            U_inv[i, j] /= U[i, i]

    # 计算A的逆矩阵
    A_inv = U_inv @ L_inv
    return A_inv
```

